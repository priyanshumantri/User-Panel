<%- include("../../includes/header", {pageName : "role" , pageHead : "Manage Roles" }) %>
    <%- include("../../includes/sidebar", {pageName : "manageRoles" , pageHead : "Manage Roles" }) %>
        <%- include("../../includes/toolbar", {pageName : "role" , pageHead : "Manage Roles" }) %>

            <div id="kt_app_content" class="app-content  flex-column-fluid ">


                <!--begin::Content container-->
                <div id="kt_app_content_container" class="app-container  container-xxl ">

                    <!--begin::Row-->
                    <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-5 g-xl-9">



                        <% roles.forEach((data, index)=> { %>
                            <div class="col-md-4">
                                <div class="card card-flush h-md-100">
                                    <!--begin::Card header-->
                                    <div class="card-header">
                                        <!--begin::Card title-->
                                        <div class="card-title">
                                            <h2><%=data.roleType%></h2>
                                        </div>
                                        <!--end::Card title-->
                                    </div>
                                    <!--end::Card header-->
                                    <!--begin::Card body-->
                                    <div class="card-body pt-1">
                                        <!--begin::Users-->
                                        <div class="fw-bold text-gray-600 mb-5">Total users with this role: <%=data.users.length%></div>
                                        <!--end::Users-->
                                        <!--begin::Permissions-->
                                        <div class="d-flex flex-column text-gray-600">
                                                <% var count = 0; %>
                                     <% data.permissions.forEach((perData, index)=> {%> 
                                        
                                      <% if(count < 3) {%> 

                                        <% if(perData.canRead === true || perData.canWrite === true || perData.canCreate === true || perData.canDelete === true) {%>
                                            <% count = count +1%>
                                        <div class="d-flex align-items-center py-2">
                                            <span class="bullet bg-primary me-3">
                                            </span> <%=perData.permissionID.permissionName%> </div>

                                            <%} %>
                                        <%} else {%> 

                                            <% return; %>

                                            <% } %>
                                            
                                        <% }) %>
                                            

                                            <% if(count >= 3) {%>
                                                <div class='d-flex align-items-center py-2'>
                                                    <span class='bullet bg-primary me-3'></span>
                                                    <em>And Many More.....</em>
                                                </div>
                                                <%} %>
                                            
                                           
                                          
                                        </div>
                                        <!--end::Permissions-->
                                    </div>
                                    <!--end::Card body-->
                                    <!--begin::Card footer-->
                                    <div class="card-footer flex-wrap pt-0">
                                        <a href="../../demo1/dist/apps/user-management/roles/view.html" class="btn btn-light btn-active-primary my-1 me-2">View Role</a>
                                        <a href="/user-management/roles/edit?id=<%=data.id%>" class="btn btn-light btn-active-light-primary my-1 me-2">Edit Role</a>

                                        
                                            
                                        <button onclick="deleteRole('<%=data.id%>')" type="button" class="btn btn-light btn-active-primary my-1 me-2">Delete Role</button>
                                        
                                    </div>
                                    <!--end::Card footer-->
                                </div>
                            </div>
                            <% }) %>




                                <!--end::Col-->

                                <!--begin::Add new card-->
                                <div class="ol-md-4">
                                    <!--begin::Card-->
                                    <div class="card h-md-100">
                                        <!--begin::Card body-->
                                        <div class="card-body d-flex flex-center">
                                            <!--begin::Button-->
                                            <button type="button" class="btn btn-clear d-flex flex-column flex-center"
                                                data-bs-toggle="modal" data-bs-target="#kt_modal_add_role">
                                                <!--begin::Illustration-->
                                                <img src="../../../assets/media/illustrations/sketchy-1/4.png" alt=""
                                                    class="mw-100 mh-150px mb-7">
                                                <!--end::Illustration-->

                                                <!--begin::Label-->
                                                <div class="fw-bold fs-3 text-gray-600 text-hover-primary">
                                                    Add New Role
                                                </div>
                                                <!--end::Label-->
                                            </button>
                                            <!--begin::Button-->
                                        </div>
                                        <!--begin::Card body-->
                                    </div>
                                    <!--begin::Card-->
                                </div>
                                <!--begin::Add new card-->
                    </div>
                    <!--end::Row-->

                    <!--begin::Modals-->
                    <%- include("addRole") %>
                    
                </div>
                <!--end::Content container-->
            </div>
            <%- include("../../includes/footer", {pageName : "role" }) %>